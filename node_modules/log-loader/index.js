


var colors = require('colors');
var path = require('path');
var utils = require('loader-utils');
var getOptions = utils.getLoaderConfig;

module.exports = logLoader;
module.exports.pitch = logLoaderPitch;

function logLoader(source) {
    var options = getOptions(this, 'logLoader');
    var id = options.id.toString();
    var file = utils.interpolateName(this, './[folder]/[name].[ext]', options)

    console.log(
        'logLoader'.yellow,
        id.green,
        file
    );
    //console.log(JSON.stringify(this.options, null, 2).yellow);

    var injection = 'var baz = require(\'' +  path.resolve('app/foo/baz') + '\'); console.log(baz('+id+'));';

    return file !== './foo/baz.js' ? injection + source : source;
}

function logLoaderPitch(remainingRequest, precedingRequest, data) {
    var options = getOptions(this, 'logLoader');
    var id = options.id.toString();

    //console.log(
    //    'logLoaderPitch'.yellow,
    //    id.green,
    //    utils.interpolateName(this, './[folder]/[name].[ext]', options)
    //);
    //console.log('remainingRequest: ', remainingRequest);
    //console.log('precedingRequest: ', precedingRequest);
    //console.log('data: ', data);

}
